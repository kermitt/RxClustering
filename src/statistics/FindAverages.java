package statistics;

import java.io.File;
import java.io.FileNotFoundException;
import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.ResultSet;
import java.sql.Statement;
import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;
import java.util.Map;
import java.util.Scanner;

import healthpath.common.Caller;
import healthpath.common.Library;
import healthpath.common.helpers.Concept;

public class FindAverages {
	// depth: 1
	// cluster: 115
	// location: 0.08, 0.24, 0.06
	// count: 5269
	// children:
	// 5,9,29,33,58,71,95,109,116,121,141,142,159,195,207,210,213,214,228,234,243,247,266,279,308,310,312,319,326,329,339,340,346,356,358,414,431,440,453,455,474,483,499,502,504,513,530,544,550,552,572,575,579,585,589,591,597,641,654,661,667,672,676,684,698,716,748,755,768,775,813,831,836,840,851,852,873,891,892,898,902,908,911,917,925,927,940,944,945,948,967,970,978,979,992,994,1001,1006,1024,1035,1036,1037,1071,1072,1078,1079,1087,1095,1107,1110,1140,1143,1146,1155,1161,1166,1169,1180,1183,1189,1201,1203,1208,1224,1249,1254,1272,1275,1277,1279,1284,1292,1315,1330,1356,1358,1365,1395,1396,1398,1401,1404,1411,1415,1421,1423,1431,1451,1452,1464,1478,1485,1487,1491,1496,1525,1526,1528,1531,1544,1561,1564,1573,1578,1585,1588,1598,1601,1605,1608,1615,1621,1626,1638,1641,1645,1661,1667,1670,1677,1702,1733,1735,1736,1739,1769,1779,1798,1800,1805,1806,1807,1809,1817,1833,1845,1862,1865,1870,1873,1874,1898,1905,1916,1922,1927,1929,1945,1948,1951,1956,1978,1982,1985,1988,1991,1992,1996,1998,2003,2020,2023,2040,2046,2051,2053,2065,2076,2083,2089,2116,2118,2139,2194,2202,2207,2220,2231,2232,2234,2235,2242,2260,2262,2263,2268,2282,2283,2284,2286,2290,2297,2308,2313,2323,2334,2335,2337,2348,2368,2405,2409,2430,2442,2443,2445,2459,2466,2471,2474,2482,2490,2498,2503,2504,2511,2516,2518,2523,2528,2529,2531,2542,2571,2573,2575,2583,2589,2591,2623,2632,2633,2655,2666,2668,2669,2673,2708,2711,2728,2746,2754,2772,2773,2781,2789,2792,2801,2803,2809,2823,2842,2854,2860,2890,2893,2902,2935,2943,2968,2985,3002,3009,3014,3016,3022,3035,3051,3064,3069,3117,3124,3141,3150,3163,3165,3172,3175,3185,3197,3206,3225,3227,3229,3237,3243,3263,3273,3321,3324,3325,3326,3331,3332,3343,3352,3363,3395,3402,3411,3422,3438,3440,3450,3452,3472,3477,3480,3482,3493,3496,3520,3521,3526,3532,3550,3552,3562,3580,3606,3623,3634,3648,3661,3691,3696,3703,3710,3726,3727,3728,3736,3762,3780,3782,3783,3785,3786,3787,3793,3794,3799,3806,3824,3827,3828,3835,3845,3846,3849,3861,3862,3878,3879,3884,3885,3896,3897,3907,3932,3936,3945,3946,3953,3981,4002,4027,4028,4034,4038,4055,4067,4097,4098,4100,4113,4137,4140,4155,4159,4169,4170,4183,4184,4240,4247,4256,4266,4271,4275,4279,4282,4283,4297,4302,4313,4324,4325,4326,4334,4343,4344,4367,4368,4375,4379,4384,4388,4397,4411,4432,4433,4456,4467,4471,4484,4489,4498,4538,4546,4553,4556,4577,4596,4608,4617,4645,4648,4654,4663,4664,4681,4692,4699,4709,4728,4730,4739,4741,4742,4762,4766,4773,4775,4790,4798,4802,4803,4809,4814,4818,4821,4828,4838,4874,4876,4879,4892,4893,4905,4914,4922,4932,4937,4938,4942,4944,4955,4959,4963,4967,4970,4976,4996,5002,5005,5007,5016,5033,5041,5046,5065,5083,5084,5096,5102,5113,5120,5122,5143,5147,5148,5156,5176,5178,5185,5187,5188,5189,5212,5219,5221,5226,5236,5242,5244,5246,5249,5259,5263,5264,5271,5272,5273,5282,5295,5314,5315,5322,5332,5364,5368,5377,5383,5385,5386,5387,5397,5399,5402,5426,5438,5442,5445,5468,5476,5483,5507,5510,5526,5541,5550,5552,5553,5558,5562,5566,5568,5579,5599,5607,5626,5641,5662,5673,5687,5716,5730,5733,5782,5799,5803,5807,5826,5834,5849,5859,5867,5875,5878,5888,5896,5902,5905,5913,5926,5930,5931,5940,5957,5971,5972,5981,5982,5984,5988,5993,5995,6010,6013,6015,6026,6036,6038,6048,6054,6058,6059,6071,6082,6086,6095,6115,6122,6127,6130,6150,6153,6155,6166,6175,6185,6209,6220,6223,6236,6237,6245,6263,6271,6273,6278,6281,6311,6321,6322,6323,6330,6332,6340,6358,6369,6376,6382,6389,6406,6411,6422,6425,6449,6472,6474,6482,6519,6523,6530,6532,6538,6543,6544,6545,6566,6579,6581,6590,6595,6616,6625,6628,6635,6639,6651,6661,6674,6682,6689,6691,6718,6722,6732,6734,6744,6745,6749,6775,6779,6781,6784,6787,6789,6790,6792,6797,6799,6805,6825,6828,6831,6837,6840,6858,6881,6888,6889,6900,6904,6915,6920,6925,6926,6928,6930,6932,6934,6944,6948,6952,6964,6967,6972,6973,6991,7011,7023,7033,7042,7059,7066,7070,7089,7095,7096,7100,7109,7112,7113,7116,7127,7133,7143,7148,7150,7161,7173,7179,7183,7187,7188,7200,7214,7222,7223,7229,7230,7232,7234,7236,7248,7253,7263,7287,7296,7297,7308,7319,7320,7323,7324,7327,7333,7334,7349,7388,7391,7400,7409,7411,7415,7417,7422,7440,7448,7453,7455,7456,7469,7472,7480,7481,7491,7501,7512,7519,7543,7553,7555,7585,7587,7613,7619,7623,7627,7631,7640,7641,7644,7646,7652,7658,7670,7684,7695,7707,7708,7717,7728,7731,7740,7741,7759,7776,7778,7786,7788,7790,7813,7814,7845,7862,7880,7886,7893,7919,7930,7932,7937,7939,7948,7954,7971,7981,7984,7998,8017,8021,8039,8042,8043,8050,8060,8068,8074,8077,8096,8102,8105,8120,8121,8128,8141,8147,8152,8175,8180,8184,8193,8199,8200,8213,8240,8253,8268,8277,8283,8284,8289,8293,8311,8313,8314,8321,8328,8353,8354,8366,8388,8389,8412,8419,8437,8464,8465,8473,8487,8500,8504,8511,8516,8553,8556,8573,8576,8582,8588,8591,8592,8597,8600,8606,8610,8623,8646,8662,8668,8675,8691,8697,8706,8717,8734,8736,8738,8745,8757,8770,8790,8796,8804,8813,8817,8822,8830,8837,8838,8840,8841,8884,8894,8899,8917,8923,8925,8932,8937,8964,8970,8972,8975,9008,9011,9014,9033,9039,9041,9049,9053,9069,9071,9073,9075,9079,9083,9085,9113,9117,9119,9128,9133,9151,9170,9180,9181,9184,9190,9193,9207,9208,9219,9224,9227,9233,9236,9241,9243,9256,9257,9330,9336,9352,9363,9406,9427,9433,9438,9447,9457,9483,9492,9494,9495,9508,9530,9537,9541,9553,9556,9561,9564,9565,9576,9581,9621,9622,9634,9638,9640,9651,9665,9678,9679,9683,9684,9685,9689,9736,9740,9741,9742,9744,9759,9760,9775,9793,9818,9840,9847,9855,9860,9882,9890,9895,9903,9910,9911,9912,9917,9936,9958,9961,9963,9969,9970,9986,9994,9996,10003,10005,10019,10027,10030,10034,10042,10047,10049,10059,10066,10072,10095,10120,10123,10125,10130,10139,10145,10146,10154,10156,10162,10163,10179,10187,10197,10203,10210,10219,10221,10236,10242,10249,10252,10257,10274,10282,10285,10295,10296,10304,10305,10327,10333,10335,10353,10356,10359,10360,10371,10375,10378,10380,10386,10387,10411,10424,10425,10431,10434,10437,10443,10449,10453,10456,10460,10461,10473,10478,10483,10496,10518,10520,10526,10539,10541,10544,10546,10583,10586,10588,10595,10599,10608,10611,10621,10629,10630,10651,10661,10666,10669,10670,10673,10681,10684,10687,10706,10710,10720,10724,10734,10736,10747,10760,10780,10782,10801,10809,10818,10887,10888,10899,10908,10909,10928,10936,10971,10973,10981,10984,10989,10998,11006,11020,11026,11062,11080,11085,11098,11114,11124,11125,11130,11137,11152,11161,11171,11176,11197,11200,11212,11214,11217,11229,11244,11280,11297,11306,11338,11345,11353,11360,11366,11376,11381,11396,11400,11407,11425,11466,11473,11474,11476,11486,11500,11504,11525,11527,11528,11529,11532,11538,11540,11548,11550,11566,11577,11590,11591,11592,11596,11612,11619,11623,11627,11632,11637,11664,11678,11686,11687,11706,11726,11727,11743,11764,11769,11770,11771,11775,11776,11783,11788,11797,11803,11822,11835,11849,11863,11864,11866,11869,11871,11878,11892,11898,11907,11908,11921,11943,11947,11984,11989,12008,12010,12027,12036,12051,12053,12060,12088,12101,12122,12130,12140,12162,12172,12176,12186,12188,12216,12217,12251,12261,12268,12274,12276,12277,12279,12285,12314,12342,12353,12355,12384,12390,12392,12403,12416,12420,12422,12437,12440,12446,12453,12457,12462,12483,12494,12502,12510,12525,12537,12540,12567,12595,12601,12602,12606,12614,12654,12670,12698,12714,12741,12743,12745,12747,12764,12766,12782,12790,12792,12804,12810,12811,12817,12834,12836,12840,12850,12851,12855,12863,12882,12903,12904,12913,12917,12921,12959,12962,12976,12985,13000,13001,13002,13008,13017,13018,13019,13022,13040,13046,13047,13060,13074,13082,13086,13088,13100,13110,13111,13116,13118,13161,13162,13170,13191,13196,13200,13223,13240,13246,13261,13283,13287,13314,13315,13317,13334,13342,13346,13347,13359,13372,13381,13383,13403,13410,13416,13434,13449,13456,13463,13465,13472,13480,13482,13493,13498,13500,13517,13534,13557,13559,13562,13568,13574,13583,13588,13589,13606,13607,13612,13618,13624,13631,13635,13656,13676,13681,13709,13713,13725,13751,13752,13754,13782,13787,13796,13829,13851,13863,13881,13887,13888,13890,13897,13901,13941,13943,14006,14010,14020,14035,14043,14054,14058,14062,14067,14088,14092,14120,14126,14127,14129,14131,14133,14138,14143,14159,14169,14177,14242,14269,14280,14285,14304,14308,14309,14310,14312,14314,14319,14357,14368,14373,14395,14396,14397,14407,14409,14413,14416,14418,14434,14439,14451,14458,14466,14468,14486,14491,14492,14504,14509,14534,14548,14553,14564,14583,14591,14632,14635,14655,14674,14682,14684,14701,14703,14710,14749,14775,14776,14780,14786,14791,14818,14827,14850,14854,14864,14866,14869,14905,14913,14914,14929,14939,14954,14960,14968,14983,14993,15003,15004,15006,15038,15045,15051,15059,15072,15077,15083,15090,15094,15104,15111,15129,15130,15135,15146,15163,15166,15172,15183,15187,15192,15205,15218,15246,15252,15255,15283,15297,15299,15305,15312,15314,15317,15329,15341,15342,15345,15368,15378,15381,15382,15393,15396,15402,15412,15431,15453,15455,15487,15500,15512,15517,15519,15541,15544,15552,15571,15574,15579,15586,15591,15608,15609,15612,15647,15662,15667,15673,15680,15685,15691,15704,15707,15768,15776,15779,15785,15791,15807,15824,15844,15845,15850,15874,15883,15896,15897,15901,15905,15908,15909,15912,15923,15930,15932,15939,15941,15942,15974,15976,15979,15982,16029,16033,16034,16037,16062,16084,16089,16111,16116,16121,16122,16124,16127,16130,16135,16153,16158,16176,16186,16194,16199,16202,16208,16214,16234,16302,16327,16329,16336,16363,16364,16382,16398,16411,16425,16459,16472,16474,16476,16477,16497,16507,16523,16526,16528,16533,16536,16558,16563,16579,16581,16583,16589,16604,16606,16611,16622,16623,16624,16632,16640,16656,16659,16676,16677,16689,16699,16714,16717,16719,16732,16733,16743,16745,16763,16779,16784,16792,16796,16797,16822,16826,16831,16836,16861,16865,16879,16890,16910,16911,16916,16920,16927,16928,16936,16951,16958,17020,17026,17039,17040,17043,17056,17057,17058,17067,17073,17079,17097,17135,17137,17154,17170,17172,17190,17206,17207,17215,17241,17244,17250,17266,17271,17275,17283,17285,17288,17290,17296,17308,17319,17359,17366,17367,17375,17391,17403,17412,17422,17423,17432,17455,17461,17462,17464,17472,17490,17549,17573,17576,17579,17580,17587,17602,17612,17628,17637,17639,17653,17655,17662,17686,17719,17723,17728,17746,17756,17757,17760,17775,17780,17783,17789,17791,17797,17799,17802,17803,17857,17866,17884,17896,17902,17906,17932,17934,17947,17948,17964,17984,17990,17994,18006,18018,18022,18025,18027,18031,18038,18042,18043,18049,18051,18057,18074,18076,18104,18108,18118,18119,18128,18135,18154,18160,18163,18180,18188,18205,18226,18229,18230,18232,18233,18235,18266,18269,18271,18283,18290,18300,18301,18305,18313,18317,18320,18326,18328,18367,18373,18379,18383,18386,18406,18407,18417,18423,18428,18429,18439,18454,18466,18474,18489,18496,18514,18523,18528,18548,18550,18557,18582,18583,18591,18594,18595,18602,18610,18623,18629,18637,18657,18669,18675,18678,18679,18688,18709,18719,18722,18729,18730,18731,18732,18752,18769,18780,18787,18788,18792,18793,18797,18798,18804,18808,18810,18814,18816,18825,18863,18870,18888,18901,18907,18916,18929,18940,18958,18964,18970,18973,18984,18992,19005,19010,19016,19017,19046,19057,19063,19065,19066,19077,19082,19088,19102,19113,19132,19149,19159,19172,19178,19210,19215,19220,19228,19231,19239,19256,19260,19263,19273,19275,19299,19301,19306,19309,19325,19337,19339,19341,19343,19346,19351,19353,19359,19360,19374,19392,19393,19411,19439,19440,19444,19450,19452,19461,19473,19484,19485,19486,19492,19503,19506,19519,19526,19531,19532,19535,19536,19552,19555,19564,19613,19616,19619,19634,19642,19650,19652,19671,19685,19693,19695,19696,19729,19737,19738,19739,19741,19743,19753,19764,19768,19774,19805,19806,19812,19820,19832,19833,19836,19852,19861,19866,19873,19874,19882,19891,19893,19898,19947,19952,19954,19955,19960,20009,20027,20032,20034,20036,20051,20052,20067,20109,20113,20115,20131,20133,20135,20140,20161,20169,20176,20190,20191,20200,20203,20215,20231,20236,20240,20245,20251,20272,20279,20280,20292,20293,20326,20334,20342,20346,20347,20355,20358,20361,20364,20365,20374,20383,20392,20404,20406,20407,20425,20458,20466,20468,20486,20488,20490,20496,20506,20517,20529,20530,20536,20539,20540,20542,20554,20556,20572,20576,20585,20587,20591,20598,20600,20602,20614,20615,20623,20636,20646,20661,20663,20664,20667,20668,20688,20703,20705,20709,20715,20742,20746,20751,20757,20760,20762,20774,20790,20797,20813,20822,20829,20831,20838,20851,20853,20856,20858,20859,20896,20902,20909,20924,20936,20938,20958,20977,20985,20994,20995,21088,21102,21112,21118,21119,21141,21143,21160,21173,21181,21196,21197,21204,21218,21227,21252,21253,21260,21268,21271,21275,21282,21287,21300,21305,21318,21342,21359,21369,21374,21379,21380,21396,21402,21405,21426,21432,21437,21448,21469,21472,21484,21485,21503,21508,21509,21525,21537,21541,21550,21551,21552,21578,21594,21602,21605,21615,21619,21627,21638,21645,21661,21675,21677,21678,21681,21709,21712,21727,21729,21741,21744,21746,21749,21763,21778,21781,21798,21808,21811,21817,21826,21838,21841,21848,21859,21950,21956,21958,21984,21986,21996,21998,22015,22016,22040,22042,22066,22089,22098,22099,22101,22105,22107,22133,22135,22140,22146,22153,22157,22163,22175,22181,22191,22193,22195,22213,22217,22220,22222,22241,22251,22252,22258,22262,22263,22264,22278,22303,22312,22313,22320,22322,22350,22352,22353,22356,22379,22399,22401,22407,22430,22452,22488,22506,22515,22516,22533,22534,22547,22559,22565,22582,22587,22590,22593,22597,22600,22618,22624,22628,22654,22666,22673,22681,22695,22699,22702,22707,22728,22732,22756,22757,22773,22788,22792,22795,22806,22815,22821,22880,22884,22890,22892,22898,22909,22913,22914,22923,22926,22929,22930,22949,22950,22951,22958,22964,22968,22985,22992,23004,23013,23022,23031,23040,23047,23073,23074,23077,23083,23095,23099,23107,23128,23145,23156,23158,23171,23195,23208,23209,23215,23217,23219,23228,23234,23238,23265,23294,23304,23306,23328,23359,23373,23376,23390,23414,23453,23514,23521,23529,23530,23539,23544,23569,23578,23589,23608,23610,23612,23644,23650,23667,23670,23671,23677,23701,23707,23709,23713,23720,23730,23736,23750,23757,23763,23768,23787,23818,23820,23826,23832,23844,23847,23877,23906,23929,23943,23944,23950,23954,23979,23991,23994,24004,24005,24006,24010,24020,24028,24034,24036,24040,24042,24044,24062,24070,24083,24085,24092,24098,24099,24102,24123,24130,24146,24158,24160,24167,24170,24178,24186,24216,24239,24240,24241,24259,24263,24276,24300,24306,24311,24332,24371,24386,24403,24409,24416,24488,24538,24544,24545,24572,24574,24587,24606,24619,24622,24629,24631,24637,24649,24658,24670,24677,24697,24707,24710,24715,24726,24734,24741,24744,24761,24764,24766,24775,24797,24810,24811,24812,24815,24834,24861,24868,24871,24879,24880,24934,24949,25001,25006,25007,25009,25012,25027,25029,25032,25040,25049,25089,25099,25106,25114,25128,25142,25159,25168,25172,25187,25194,25203,25208,25217,25218,25246,25255,25256,25261,25264,25268,25275,25289,25293,25311,25312,25317,25318,25319,25326,25333,25343,25360,25383,25385,25393,25394,25397,25434,25437,25452,25466,25475,25480,25484,25495,25497,25498,25516,25524,25533,25536,25549,25563,25566,25587,25596,25610,25617,25632,25637,25644,25669,25678,25680,25681,25683,25686,25687,25689,25691,25708,25724,25735,25739,25769,25774,25792,25802,25809,25820,25835,25837,25844,25845,25849,25861,25867,25883,25900,25901,25903,25904,25906,25907,25909,25913,25914,25930,25936,25945,25956,25967,25972,25995,25996,25998,26003,26004,26009,26010,26021,26022,26029,26034,26043,26078,26082,26083,26096,26099,26107,26159,26171,26173,26185,26189,26216,26238,26247,26285,26286,26290,26328,26341,26346,26349,26352,26362,26363,26374,26389,26391,26393,26395,26399,26407,26411,26423,26444,26451,26456,26458,26465,26473,26503,26507,26510,26521,26540,26548,26556,26563,26570,26571,26584,26592,26611,26612,26617,26634,26637,26638,26647,26650,26676,26692,26694,26710,26713,26719,26720,26721,26739,26741,26744,26754,26774,26781,26783,26793,26794,26797,26799,26812,26823,26833,26847,26850,26851,26874,26888,26899,26902,26907,26911,26914,26925,26927,26932,26938,26962,26976,26980,26988,26989,27004,27012,27013,27015,27028,27036,27044,27045,27061,27065,27068,27085,27095,27111,27113,27117,27126,27127,27141,27189,27196,27199,27200,27210,27215,27227,27233,27266,27276,27277,27281,27294,27302,27307,27317,27340,27348,27391,27395,27415,27431,27448,27457,27462,27468,27480,27494,27499,27504,27505,27524,27538,27541,27565,27568,27586,27588,27598,27604,27611,27616,27622,27626,27631,27642,27693,27722,27723,27755,27766,27767,27786,27794,27801,27803,27815,27829,27830,27832,27849,27856,27859,27862,27867,27872,27875,27889,27895,27910,27918,27936,27941,27944,27945,27960,27961,27977,27992,27997,27999,28001,28002,28005,28043,28061,28068,28070,28072,28079,28091,28094,28114,28119,28146,28149,28157,28177,28182,28192,28199,28223,28237,28249,28282,28283,28293,28301,28309,28310,28316,28369,28377,28381,28400,28401,28414,28424,28427,28446,28452,28497,28498,28506,28510,28514,28525,28527,28538,28551,28560,28565,28579,28596,28624,28633,28662,28685,28692,28694,28702,28729,28733,28743,28747,28749,28752,28756,28773,28777,28783,28796,28805,28837,28881,28883,28885,28888,28893,28897,28901,28909,28956,28968,28972,28982,28995,29017,29029,29031,29046,29048,29065,29079,29081,29090,29102,29112,29114,29121,29127,29132,29137,29140,29153,29154,29164,29165,29181,29192,29196,29231,29244,29251,29288,29301,29316,29334,29344,29349,29391,29408,29413,29420,29444,29454,29477,29484,29501,29513,29521,29529,29552,29554,29556,29558,29561,29568,29582,29597,29608,29625,29635,29638,29650,29657,29662,29696,29701,29716,29730,29737,29738,29747,29752,29757,29761,29763,29765,29776,29780,29795,29800,29803,29821,29830,29838,29855,29862,29877,29880,29889,29899,29966,29973,29975,29978,30019,30022,30023,30027,30045,30049,30058,30075,30109,30113,30120,30125,30145,30156,30170,30178,30195,30206,30212,30213,30220,30229,30231,30244,30247,30264,30271,30274,30280,30282,30307,30317,30325,30337,30339,30340,30345,30348,30350,30358,30362,30369,30375,30377,30407,30410,30423,30424,30426,30432,30435,30441,30448,30454,30457,30487,30488,30497,30532,30550,30552,30557,30565,30578,30593,30610,30618,30620,30624,30630,30638,30640,30642,30643,30647,30649,30653,30670,30672,30693,30700,30708,30710,30714,30716,30718,30719,30739,30745,30747,30760,30777,30790,30799,30806,30818,30827,30834,30886,30888,30908,30924,30941,30944,30949,30951,30964,30966,30972,30985,30992,30997,30998,31001,31003,31023,31029,31030,31035,31049,31053,31088,31096,31098,31099,31101,31103,31105,31123,31135,31137,31140,31156,31170,31186,31193,31201,31214,31219,31220,31222,31228,31230,31234,31237,31253,31282,31303,31307,31314,31339,31340,31345,31346,31359,31367,31380,31386,31391,31393,31399,31402,31415,31421,31425,31428,31452,31456,31459,31460,31467,31468,31480,31507,31521,31535,31537,31544,31559,31585,31596,31617,31629,31695,31699,31701,31703,31709,31712,31735,31737,31746,31764,31778,31779,31788,31815,31832,31844,31848,31853,31857,31882,31901,31918,31945,31952,31957,31973,32005,32008,32013,32022,32033,32034,32035,32048,32050,32062,32073,32080,32113,32122,32139,32144,32154,32158,32166,32167,32168,32171,32193,32203,32211,32214,32226,32236,32269,32277,32288,32303,32322,32325,32329,32334,32347,32356,32365,32369,32371,32386,32395,32417,32424,32431,32434,32444,32462,32470,32474,32478,32484,32495,32499,32504,32520,32560,32570,32577,32589,32592,32604,32609,32610,32616,32621,32632,32640,32653,32658,32659,32669,32672,32675,32680,32685,32688,32690,32697,32713,32715,32717,32721,32728,32729,32734,32744,32753,32768,32776,32779,32784,32787,32792,32801,32818,32822,32845,32851,32858,32861,32866,32890,32891,32899,32914,32916,32917,32920,32926,32949,32959,32963,32969,32991,32993,33003,33008,33010,33013,33019,33023,33027,33038,33056,33067,33079,33139,33152,33171,33173,33180,33185,33200,33202,33215,33230,33245,33252,33278,33291,33295,33297,33298,33305,33308,33313,33326,33334,33346,33347,33354,33356,33370,33379,33401,33417,33422,33423,33424,33439,33453,33476,33488,33505,33516,33518,33536,33538,33561,33562,33566,33574,33579,33583,33602,33607,33643,33653,33671,33674,33682,33698,33702,33711,33724,33728,33729,33732,33742,33759,33781,33821,33825,33862,33880,33881,33883,33889,33898,33916,33923,33925,33930,33931,33938,33946,33949,33953,33957,33996,34000,34012,34019,34041,34053,34066,34074,34076,34084,34091,34104,34117,34142,34144,34159,34160,34164,34167,34174,34184,34191,34195,34216,34236,34239,34241,34248,34251,34254,34258,34267,34281,34284,34297,34298,34313,34333,34344,34345,34360,34364,34369,34383,34386,34391,34397,34417,34420,34445,34457,34464,34467,34492,34498,34502,34518,34528,34540,34543,34576,34591,34596,34616,34665,34670,34679,34687,34693,34703,34715,34725,34729,34750,34754,34757,34768,34775,34784,34808,34811,34826,34828,34833,34838,34859,34861,34862,34865,34871,34879,34885,34901,34909,34915,34938,34939,34959,34979,34986,34989,34997,35005,35007,35008,35011,35028,35030,35057,35064,35069,35072,35094,35109,35135,35139,35153,35182,35184,35188,35196,35198,35225,35238,35248,35256,35265,35266,35267,35269,35296,35300,35323,35337,35365,35378,35389,35415,35427,35431,35442,35453,35455,35484,35489,35497,35498,35503,35506,35515,35518,35525,35529,35542,35543,35549,35557,35562,35586,35594,35604,35607,35626,35645,35651,35655,35665,35690,35696,35698,35707,35715,35720,35724,35726,35733,35736,35751,35768,35773,35790,35792,35794,35801,35813,35830,35846,35847,35885,35895,35919,35929,35944,35952,35954,35978,35990,35998,35999,36002,36009,36013,36017,36024,36036,36053,36062,36063,36065,36078,36082,36097,36103,36105,36125,36135,36137,36140,36143,36146,36155,36158,36169,36182,36192,36204,36205,36220,36240,36252,36259,36261,36262,36287,36288,36293,36294,36296,36300,36305,36325,36334,36336,36339,36349,36356,36363,36381,36388,36400,36423,36429,36441,36444,36446,36464,36483,36487,36493,36527,36538,36540,36542,36545,36555,36568,36588,36601,36619,36644,36649,36669,36670,36689,36716,36718,36719,36722,36728,36735,36743,36757,36774,36798,36805,36812,36835,36860,36862,36897,36905,36907,36908,36912,36918,36919,36925,36930,36938,36954,36985,36997,37008,37024,37027,37033,37034,37038,37054,37057,37068,37075,37081,37082,37086,37090,37099,37101,37103,37105,37112,37138,37154,37156,37160,37163,37165,37188,37191,37199,37202,37209,37227,37236,37238,37248,37251,37277,37303,37304,37306,37309,37312,37318,37342,37373,37390,37391,37393,37400,37401,37414,37419,37424,37450,37463,37465,37466,37474,37476,37478,37487,37514,37518,37538,37552,37578,37580,37590,37591,37593,37606,37612,37630,37639,37641,37642,37647,37648,37649,37651,37653,37658,37659,37661,37662,37670,37674,37675,37677,37681,37688,37696,37734,37757,37764,37791,37797,37813,37814,37825,37833,37839,37850,37873,37878,37879,37883,37887,37893,37905,37913,37915,37923,37953,37956,37959,37976,37987,37993,37998,38009,38027,38049,38051,38052,38056,38059,38071,38080,38085,38089,38102,38103,38124,38125,38140,38162,38170,38194,38208,38216,38224,38246,38277,38291,38334,38340,38365,38368,38371,38372,38374,38376,38386,38387,38400,38403,38411,38417,38427,38428,38429,38430,38432,38442,38444,38445,38468,38472,38486,38488,38490,38491,38495,38501,38512,38525,38536,38538,38550,38577,38578,38579,38581,38589,38599,38602,38620,38622,38624,38625,38638,38650,38655,38670,38672,38674,38677,38690,38697,38707,38715,38720,38742,38747,38748,38750,38754,38766,38767,38780,38783,38788,38789,38795,38796,38811,38815,38827,38842,38852,38856,38861,38872,38877,38902,38910,38924,38931,38942,38961,38963,38965,38972,38976,38978,39006,39010,39024,39036,39039,39048,39069,39088,39115,39121,39132,39143,39146,39154,39163,39165,39171,39189,39192,39200,39205,39208,39213,39226,39241,39245,39248,39252,39254,39264,39267,39278,39283,39301,39327,39338,39348,39356,39357,39379,39389,39393,39402,39418,39420,39424,39425,39430,39433,39455,39462,39463,39481,39492,39526,39528,39543,39551,39569,39570,39574,39580,39584,39611,39615,39630,39637,39638,39640,39652,39657,39678,39683,39698,39699,39706,39709,39716,39734,39737,39739,39740,39761,39778,39783,39793,39802,39818,39825,39829,39839,39842,39856,39864,39866,39871,39872,39875,39917,39926,39927,39938,39941,39948,39957,39970,39973,39976,39984,39985,39990,40019,40038,40047,40061,40067,40073,40076,40089,40095,40096,40110,40111,40122,40135,40142,40157,40162,40165,40167,40186,40214,40231,40232,40233,40252,40254,40255,40273,40297,40300,40301,40305,40307,40320,40335,40348,40351,40363,40364,40374,40384,40386,40390,40394,40399,40405,40406,40441,40460,40468,40482,40506,40535,40564,40566,40598,40599,40640,40656,40659,40672,40709,40716,40728,40730,40739,40742,40750,40755,40777,40794,40801,40804,40805,40834,40838,40849,40860,40869,40872,40886,40901,40914,40922,40926,40934,40942,40958,40961,40968,40971,40979,40987,40994,41009,41021,41023,41024,41025,41030,41037,41039,41040,41062,41066,41076,41082,41089,41104,41170,41193,41203,41218,41224,41231,41243,41247,41250,41267,41292,41301,41314,41332,41350,41358,41359,41377,41384,41390,41401,41420,41429,41442,41446,41459,41470,41501,41521,41532,41543,41553,41556,41568,41570,41602,41612,41625,41638,41644,41645,41648,41655,41679,41703,41720,41733,41739,41742,41764,41767,41781,41789,41791,41792,41793,41797,41811,41814,41827,41828,41837,41863,41864,41881,41882,41883,41902,41910,41916,41917,41928,41930,41934,41938,41939,41949,41951,41955,41970,41980,41993,41996,41999,42026,42035,42049,42083,42089,42103,42129,42133,42158,42187,42196,42198,42220,42221,42225,42234,42235,42262,42270,42272,42288,42298,42302,42334,42335,42340,42342,42345,42364,42369,42408,42414,42416,42440,42447,42454,42458,42468,42469,42483,42493,42494,42498,42499,42502,42510,42515,42516,42528,42531,42533,42560,42564,42568,42572,42583,42589,42597,42615,42617,42620,42629,42636,42637,42653,42657,42659,42662,42664,42674,42681,42696,42710,42714,42730,42732,42744,42745,42750,42753,42755,42756,42758,42760,42809,42810,42811,42828,42870,42873,42877,42886,42910,42911,42923,42958,42960,42966,42967,42970,42972,42981,42982,42985,42995,43000,43002,43018,43022,43028,43030,43062,43072,43089,43093,43098,43099,43109,43130,43136,43160,43168,43186,43200,43218,43230,43234,43268,43271,43278,43280,43294,43310,43311,43313,43319,43321,43339,43366,43378,43381,43382,43397,43412,43420,43425,43432,43457,43469,43473,43483,43484,43493,43494,43510,43525,43526,43529,43554,43560,43576,43585,43598,43608,43619,43647,43663,43665,43683,43685,43692,43695,43718,43757,43776,43787,43789,43805,43809,43811,43832,43835,43857,43865,43906,43929,43938,43959,43962,43963,43975,43981,44008,44028,44047,44056,44085,44090,44117,44133,44137,44140,44153,44157,44179,44192,44194,44200,44202,44206,44235,44250,44259,44265,44268,44285,44289,44290,44304,44318,44340,44359,44368,44377,44398,44402,44424,44425,44441,44444,44449,44460,44472,44474,44476,44487,44494,44503,44504,44509,44510,44527,44531,44535,44539,44540,44546,44565,44600,44607,44614,44630,44641,44643,44664,44676,44689,44692,44708,44709,44710,44714,44715,44720,44741,44744,44745,44752,44754,44756,44760,44769,44770,44775,44782,44789,44790,44793,44814,44832,44842,44858,44860,44867,44874,44883,44889,44912,44914,44917,44938,44948,44951,44958,44961,44978,45007,45017,45049,45062,45069,45070,45076,45084,45091,45097,45107,45109,45110,45111,45143,45153,45168,45172,45179,45209,45220,45235,45240,45246,45248,45253,45265,45272,45280,45299,45300,45304,45307,45308,45331,45335,45336,45348,45349,45357,45360,45363,45369,45402,45404,45411,45444,45459,45462,45472,45488,45495,45498,45523,45524,45533,45537,45548,45559,45575,45579,45595,45618,45619,45623,45638,45643,45646,45652,45660,45673,45674,45677,45679,45707,45713,45735,45742,45746,45753,45759,45780,45789,45806,45830,45833,45859,45875,45885,45909,45925,45929,45939,45964,45965,45977,45987,45993,45996,46000,46005,46007,46024,46027,46034,46035,46040,46041,46065,46072,46085,46099,46108,46109,46117,46164,46167,46172,46180,46184,46192,46198,46216,46217,46240,46243,46257,46266,46269,46279,46284,46285,46287,46291,46293,46306,46309,46316,46324,46332,46336,46342,46366,46370,46390,46414,46420,46426,46436,46440,46447,46453,46457,46467,46485,46509,46513,46527,46547,46548,46549,46556,46561,46576,46577,46584,46595,46598,46606,46608,46609,46611,46614,46617,46633,46637,46652,46654,46659,46665,46669,46676,46682,46683,46716,46720,46721,46737,46738,46753,46790,46813,46816,46840,46842,46846,46848,46860,46866,46868,46878,46880,46892,46900,46904,46909,46913,46931,46939,46942,46947,46949,46951,46955,46975,47001,47017,47022,47025,47030,47039,47040,47050,47062,47066,47070,47092,47115,47126,47128,47130,47137,47140,47161,47169,47188,47197,47208,47237,47239,47243,47245,47246,47273,47283,47288,47289,47292,47293,47304,47311,47327,47353,47354,47365,47368,47371,47379,47380,47384,47390,47427,47433,47454,47459,47467,47476,47480,47497,47500,47502,47507,47508,47511,47518,47524,47529,47532,47540,47543,47549,47557,47572,47579,47580,47593,47619,47627,47642,47678,47681,47685,47688,47695,47705,47706,47713,47715,47716,47732,47738,47740,47758,47762,47764,47781,47785,47794,47802,47804,47807,47809,47825,47828,47842,47844,47857,47862,47869,47881,47888,47895,47909,47933,47950,47964,47968,47969,47971,47972,47989,47999,48006,48012,48013,48020,48022,48023,48029,48035,48043,48053,48054,48062,48078,48116,48117,48127,48136,48140,48151,48152,48156,48164,48181,48189,48198,48201,48217,48235,48254,48262,48287,48306,48313,48315,48316,48322,48331,48337,48338,48345,48349,48354,48357,48358,48372,48385,48386,48390,48404,48409,48429,48430,48453,48457,48466,48467,48488,48507,48523,48526,48533,48553,48556,48560,48570,48581,48583,48600,48608,48614,48637,48643,48645,48650,48653,48658,48664,48688,48705,48710,48714,48721,48723,48732,48736,48741,48745,48750,48789,48811,48822,48842,48846,48850,48893,48896,48915,48916,48936,48954,48970,48971,48980,48990,49001,49021,49025,49026,49039,49042,49058,49077,49083,49091,49096,49101,49122,49152,49154,49156,49168,49175,49183,49189,49204,49222,49235,49236,49239,49265,49276,49287,49293,49296,49303,49318,49323,49327,49345,49351,49353,49357,49371,49383,49386,49392,49402,49439,49441,49464,49483,49484,49496,49538,49540,49562,49568,49587,49599,49600,49608,49626,49629,49632,49636,49661,49683,49698,49699,49701,49717,49723,49724,49727,49733,49740,49741,49747,49750,49758,49770,49778,49788,49798,49799,49804,49805,49833,49847,49849,49853,49874,49879,49892,49897,49902,49904,49913,49924,49927,49951,49963,49964,49976,49984,49990,50013,50051,50052,50060,50088,50102,50104,50106,50111,50114,50121,50126,50131,50145,50164,50168,50174,50183,50190,50201,50203,50219,50224,50230,50242,50247,50248,50255,50268,50269,50283,50285,50288,50300,50305,50314,50318,50320,50324,50327

	public Record getPeople(Integer recordId, String gaint_list_of_ids) {
		Record record = new Record(recordId);
		try {
			Class.forName("org.sqlite.JDBC");
			// String sql = "select * from CONCEPTS_META where feature = '" +
			// feature + "' and payload = '" + payload + "'";

			String sql = "select id, patient_paid, ingredient_cost, days_supply, complexity, pain, velocity from person_calc where id in ("
					+ gaint_list_of_ids + ")";

			// Caller.log(sql);
			Connection connection = DriverManager.getConnection(Library.db_location);

			Statement stmt = connection.createStatement();
			ResultSet rs = stmt.executeQuery(sql);
			while (rs.next()) {

				int id = rs.getInt("id");
				int patient_paid = rs.getInt("patient_paid");
				int ingredient_cost = rs.getInt("ingredient_cost");
				int days_supply = rs.getInt("days_supply");
				int complexity = rs.getInt("complexity");
				int pain = rs.getInt("pain");
				int velocity = rs.getInt("velocity");

				record.donate(patient_paid, ingredient_cost, days_supply, complexity, pain, velocity);
			}
			rs.close();
			stmt.close();
			connection.close();
		} catch (Exception boom) {
			System.out.println("Fail! " + boom.getMessage());
			boom.printStackTrace();
		}
//		record.finish();
		return record;
	}

	public Map<Integer, Record> readResults(String file) throws FileNotFoundException {

		Map<Integer, Record> records = new HashMap<>();

		Caller.log("Reading " + file);
		int key = 0;
		Scanner inputFile = new Scanner(new File(file));
		while (inputFile.hasNext()) {
			String x = inputFile.nextLine();
			if (x.startsWith(".....................")) {
				key++;
				Record r = new Record(key);
				records.put(key, r);
			} else if (x.startsWith("depth:")) {
				records.get(key).setDepth(x);
			} else if (x.startsWith("cluster:")) {
				records.get(key).setId(x);
			} else if (x.startsWith("location:")) {
				records.get(key).setLocation(x);
			} else if (x.startsWith("count:")) {
				records.get(key).setCount(x);
			} else if (x.startsWith("children:")) {
				records.get(key).setChildren(x);
				Caller.log("CHILDREN: " + x.length());
			}
		}
		Caller.note("Total depth " + key);
		/*
		 * for (Integer id : records.keySet()) { Record r = records.get(id);
		 * Caller.log("\n" + r.show()); }
		 */
		return records;
	}

	private String info(String candidate) {
		String s = candidate.split(":")[1];
		s = s.trim();
		return s;
	}
}
